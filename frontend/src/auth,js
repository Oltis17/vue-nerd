import axios from 'axios';

const LOCAL_STORAGE_ACCESS_TOKEN_KEY = 'access_token';

export function setAxiosAccessToken(accessToken) {
  if (accessToken) {
    axios.defaults.headers.common.Authorization = `${accessToken}`;
  } else {
    delete axios.defaults.headers.common.Authorization;
  }
}

export function setAccessToken(accessToken) {
  if (accessToken) {
    localStorage.setItem(LOCAL_STORAGE_ACCESS_TOKEN_KEY, accessToken);
  } else {
    localStorage.removeItem(LOCAL_STORAGE_ACCESS_TOKEN_KEY);
  }
}

export function removeAccessToken() {
  localStorage.removeItem(LOCAL_STORAGE_ACCESS_TOKEN_KEY);
}

export function getAccessToken() {
  return localStorage.getItem(LOCAL_STORAGE_ACCESS_TOKEN_KEY);
}

export function isLoggedIn() {
  return !!getAccessToken();
}

export const ifNotAuthenticated = async (to, from, next) => {
  if (!isLoggedIn()) {
    next();
  } else {
    next('/');
  }
};

export const ifAuthenticated = async (to, from, next) => {
  if (isLoggedIn()) {
    next();
    return;
  }
  next('/login');
};

